<%= stylesheet_link_tag 'deliveries-index' %>

<div id="header">
  <%= link_to image_tag("foremore-logo.jpeg", id: "logo"), "/" %>

  <h2>Deliveries</h2>

  <% if flash[:notice] %>
    <div id="notice">
      <%= flash[:notice] %>
    </div>
  <% end %>

  <h3><%= link_to "New delivery", deliveries_new_path, id: "new-delivery" %></h3>

</div>

<%= paginate @deliveries %>

<div id="deliveries">
  <%= form_with(url: deliveries_path, method: :get, local: true, id: "filter") do %>
    <div id="filter-buttons">
      <%= link_to 'Clear filter', deliveries_path %>
      <%= submit_tag "Apply filter" %>
    </div>
    <%= text_field_tag :pickup_address, params[:pickup_address], placeholder: "Enter pickup address" %>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <%= text_field_tag :driver_name, params[:driver_name], placeholder: "Enter driver name" %>
  <% end %>

  <% included_columns = ['pickup_address', 'delivery_address', 'weight', 'distance', 'scheduled_time', 'cost', 'driver_name'] %>
  <% included_columns.each do |column| %>
    <div class="header"><strong><%= column.humanize %></strong></div>
  <% end %>

  <% @deliveries.each do |delivery| %>
    <div><%= delivery.pickup_address %></div>
    <div><%= delivery.delivery_address %></div>
    <div><%= delivery.weight %></div>
    <div><%= delivery.distance %></div>
    <div><%= delivery.scheduled_time.strftime("%B %d, %Y %H:%M") %></div>
    <div><%= number_to_currency(delivery.cost) %></div>
    <div><%= delivery.driver_name || "N/A" %></div>
  <% end %>

  <div id="total-cost">
    <strong>Total Cost:</strong><br><%= number_to_currency(@total_cost) %>
  </div>

</div>
